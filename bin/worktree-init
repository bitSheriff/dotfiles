#! /usr/bin/bash

url=${1}
dir=${2}

mkdir ${dir}
cd ${dir}
git clone --bare ${url} .bare
echo "gitdir: ./.bare" >.git

git config remote.origin.fetch '+refs/heads/*:refs/remotes/origin/*'
git fetch
git for-each-ref --format='%(refname:short)' refs/heads | xargs -n1 -I{} git branch --set-upstream-to=origin/{}
git worktree add main
